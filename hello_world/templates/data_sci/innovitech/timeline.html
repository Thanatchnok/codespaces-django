{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="{% static 'timeline.css' %}">
    <title>Movie Review Design</title>
</head>
<body>

    <div class="container">
        
        <div class="box main-box">
            <div class="tv-show" style="width: 100px; height: 41px;">
                <a href="{% url 'homepage' %}">
                    <button style=" width: 250%; height: 100%; font-size: 20px; font-weight: bold; color: blue;">Back to Homepage</button>
                </a>
            </div>
            <div class="box third-box" style="margin-top: 20px;">
                
                <div><img class="profile-img" src="{% static 'img/profileimage01.jpg' %}" alt="User Profile"></div>
                <div class="profile-section">
                    <h2>@userZeedZad</h2>
                    <p>This movie is very Scary. I was shocked because the monster looks horrible.</p>
                    <div class="review-box">
                        <span class="scary-icon"><h8>üéÉ Scary Review üéÉ Message detection from user </h8></span>
                    </div>
                </div>
                <div class="review-section">
                    <div class="rating">
                        ‚òÖ ‚òÖ ‚òÖ ‚òÖ ‚òÜ
                    </div>
                    <button>View</button>
                </div>
                <div class="movie-section">
                    <img class="movie-img" src="{% static 'img/movieimage01.jpg' %}" alt="Movie Poster">
                    <h10>Five Nights At Freddy's</h10>
                </div>
            </div>
            <br>
            <div class="box third-box">
                <div><img class="profile-img" src="{% static 'img/profileimage05.jpg' %}" alt="User Profile"></div>
                <div class="profile-section">
                    <h2>@user12345</h2>
                    <p>‚ÄúEverybody, try laughing. Then whatever scares you will go away! ‚Äù - Tatsuo KusakabeTwo young sisters move into a new house with their father so they can be closer to their mother who is in hospital. The children soon discover a large rabbit like spirit named, Totoro, living in the forest around their new house and set to work befriending him.</p>
                    <div class="review-box2">
                        <span class="positive-icon"><h8>üëç ‚úìPositive Review‚úì üëç Message detection from user </h8></span>
                    </div>
                </div>
                <div class="review-section">
                    <div class="rating">
                        ‚òÖ ‚òÖ ‚òÖ ‚òÖ ‚òÜ
                    </div>
                    <button>View</button>
                </div>
                <div class="movie-section">
                    <img class="movie-img" src="{% static 'img/movieimage04.jpg' %}" alt="Movie Poster">
                    <h10>Totoro</h10>
                </div>
            </div>
            <br>
            <div class="box third-box">
                <div><img class="profile-img" src="{% static 'img/profileimage04.jpg' %}" alt="User Profile"></div>
                <div class="profile-section">
                    <h2>@user6789</h2>
                    <p>This is romantic. I really feel warm and romantic.very good i want to watch it again</p>
                    <div class="review-box3">
                        <span class="romantic-icon"><h8>‚ù§Ô∏è feel warm and romantic ‚ù§Ô∏è Message detection from user </h8></span>
                    </div>
                </div>
                <div class="review-section">
                    <div class="rating">
                        ‚òÖ ‚òÖ ‚òÖ ‚òÖ ‚òÜ
                    </div>
                    <button>View</button>
                </div>
                <div class="movie-section">
                    <img class="movie-img" src="{% static 'img/movieimage03.jpg' %}" alt="Movie Poster">
                    <h10>Your Name</h10>
                </div>
            </div>
        </div>
    
        
        <div class="box secondary-box">
            <div class="follow-header">Who to follow</div>
            <div class="follow-section">
                <div class="follow-profile">
                    <div><img class="follow-img" src="{% static 'img/profileimage01.jpg' %}" alt="User Profile"></div>
                    <h2>JohnDoe1985</h2>
                    <button>Follow</button>
                    <div><img class="follow-img" src="{% static 'img/profileimage06.jpg' %}" alt="User Profile"></div>
                    <h2>MountainHiker22</h2>
                    <button>Follow</button>
                    <div><img class="follow-img" src="{% static 'img/profileimage07.jpg' %}" alt="User Profile"></div>
                    <h2>ArtisticSoul55</h2>
                    <button>Follow</button>
                    <div><img class="follow-img" src="{% static 'img/profileimage08.jpg' %}" alt="User Profile"></div>
                    <h2>FallOut76</h2>
                    <button>Follow</button>
                    <div><img class="follow-img" src="{% static 'img/profileimage09.jpg' %}" alt="User Profile"></div>
                    <h2>CyberPunk2077</h2>
                    <button>Follow</button>
                </div>
                <br>
                <div style="width: 80%; margin: auto;">
                    <canvas id="sentimentChart" width="400" height="200"></canvas>
                </div>
            
                
                <div class="show-more">Show more</div>
                <div class="community-section">
                    <h1>Community</h1>
                    <div class="image-grid">
                        <div class="image-wrapper"><img src="{% static 'img/profileimage01.jpg' %}" alt="Community Image 1"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage01.jpg' %}" alt="Community Image 2"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage02.jpg' %}" alt="Community Image 3"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage03.jpg' %}" alt="Community Image 4"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage04.jpg' %}" alt="Community Image 5"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage05.jpg' %}" alt="Community Image 6"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage06.jpg' %}" alt="Community Image 7"></div>
                        <div class="image-wrapper"><img src="{% static 'img/communityImage07.jpg' %}" alt="Community Image 8"></div>
                    </div>
                
                </div>
                <button id="refreshButton" onclick="refreshPage()">Refresh Data</button>

                
            </div>
        </div>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const ctx = document.getElementById('sentimentChart').getContext('2d');
        
                async function fetchDataAndRenderChart() {
                    try {
                        // Fetch data from Django view
                        const response = await fetch('/example/visualize_d3/');
                        const data = await response.json();
        
                        console.log('Data fetched:', data);
        
                        // Clear existing chart
                        if (window.myChart) {
                            window.myChart.destroy();
                        }
        
                        // Render the chart using fetched data
                        window.myChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: data.sentiment,
                                datasets: [{
                                    label: 'Sentiment Counts',
                                    data: data.counts,
                                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                    borderColor: 'rgba(75, 192, 192, 1)',
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });
                    } catch (error) {
                        console.error('Error fetching data:', error);
                    }
                }
        
                // Initial chart rendering
                fetchDataAndRenderChart();
        
                // Add event listener to the button
                const refreshButton = document.getElementById('refreshButton');
                refreshButton.addEventListener('click', fetchDataAndRenderChart);
            });
        </script>
        
        

            
</div>

</body>
</html>
